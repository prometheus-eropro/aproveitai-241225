<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cart√£o AproveitAI</title>

  <style>
    body{font-family:Arial,sans-serif;margin:0;background:#fff}
    header{text-align:center;padding:20px}
    .brandline{display:grid;grid-template-columns:140px 1fr 140px;gap:12px;align-items:center;justify-items:center;max-width:1000px;margin:18px auto 0;padding:0 12px}
    .brandline img{height:110px;object-fit:contain}
    .pill{background:#e9fff1;border:1px solid #b7efc2;color:#0a4c1a;border-radius:999px;padding:14px 24px;font-weight:900;font-size:2rem;text-align:center}
    .slogan{text-align:center;color:#0a7f2e;font-weight:700;margin:6px 0 18px}
    .hero{max-width:980px;margin:0 auto;padding:0 12px}
    .cta{background:#fff;border-radius:14px;box-shadow:0 6px 22px #0001;padding:18px 16px;margin:14px auto}
    .cta h3{margin:0 0 6px;text-align:center}
    .cta p{margin:0;text-align:center;color:#333}
    .btns{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin:14px 0 0}
    .btn{background:#0a7f2e;color:#fff;border:none;border-radius:10px;padding:12px 16px;font-weight:800;cursor:pointer;text-decoration:none;display:inline-block}
    .filters{background:linear-gradient(135deg,#bdeeff,#81d4fa);padding:14px 12px;margin-top:10px}
    .filters .row{max-width:980px;margin:0 auto;display:grid;grid-template-columns:1fr 220px 220px 120px;gap:10px}
    input,select{padding:10px;border-radius:8px;border:1px solid #cfd6dd}
    .grid{max-width:980px;margin:0 auto;padding:16px 12px;display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
    .card{background:#fff;border-radius:14px;box-shadow:0 6px 22px #0001;padding:14px;display:grid;grid-template-columns:62px 1fr;gap:12px;align-items:center}
    .logo{width:62px;height:62px;border-radius:12px;object-fit:contain;background:#f4f7f9;border:1px solid #e5eaee}
    .nome{font-weight:900;color:#0a4c1a;margin:0}
    .meta{margin:4px 0 0;color:#333;font-size:.95rem}
    .tag{display:inline-block;margin-top:8px;background:#e9fff1;border:1px solid #b7efc2;color:#0a4c1a;border-radius:999px;padding:5px 10px;font-weight:800;font-size:.85rem}
    .foot{background:#063d1b;color:#fff;margin-top:10px}
    .foot .wrap{max-width:980px;margin:0 auto;padding:18px 12px;display:grid;grid-template-columns:1.2fr 1fr 1fr;gap:18px}
    .foot a{color:#bff7cc;text-decoration:none}
    @media (max-width:920px){
      .filters .row{grid-template-columns:1fr 1fr; }
    }
  </style>
</head>

<body>

  <header class="brandline">
    <img src="logo-prometheus.png" alt="Prometheus EROPRO" />
    <div class="pill">Cart√£o AproveitAI</div>
    <img src="logo-aproveitai.png" alt="AproveitAI" />
  </header>

  <div class="slogan">Tecnologia com Consci√™ncIA gera Resultado.</div>

  <div class="hero">
    <div class="cta">
      <h3>Bem-vindo √† PROMETHEUS EROPRO Solu√ß√µes Inteligentes!</h3>
      <p>Assine e experimente o <b>Cart√£o AproveitAI</b> e comece a economizar de verdade.</p>
      <div class="btns">
        <a class="btn" href="#" id="btnQueroCliente">Quero ser Cliente</a>
        <a class="btn" href="painelcliente.html">√Årea do Cliente</a>
        <a class="btn" href="painelparceiro.html">√Årea do Parceiro</a>
        <a class="btn" href="#" id="btnQueroParceiro">Quero ser Parceiro</a>
      </div>
    </div>
  </div>

  <div class="filters">
    <div class="row">
      <input id="buscaNome" placeholder="Buscar por nome..." />
      <select id="filtroCidade"><option value="">Todas as cidades</option></select>
      <select id="filtroRamo"><option value="">Todos os ramos</option></select>
      <button class="btn" id="btnFiltrar">Filtrar</button>
    </div>
  </div>

  <div id="status" style="text-align:center;padding:10px;color:#0a4c1a;font-weight:800;">Carregando parceiros...</div>
  <div id="listaParceiros" class="grid"></div>

  <footer class="foot">
    <div class="wrap">
      <div>
        <div style="font-weight:900;font-size:1.2rem">Cart√£o AproveitAI</div>
        <div>PROMETHEUS EROPRO Solu√ß√µes Inteligentes LTDA</div>
        <div>CNPJ: 58.584.332/0001-40</div>
        <div>üìß <a href="mailto:cartao.aproveitai@gmail.com">cartao.aproveitai@gmail.com</a></div>
        <div>üìû WhatsApp: (28) 99969-2303</div>
        <div>üì∑ Instagram: <a href="https://instagram.com/cartao.aproveitai" target="_blank" rel="noreferrer">@cartao.aproveitai</a></div>
      </div>
      <div>
        <div style="font-weight:900;margin-bottom:6px">Links R√°pidos</div>
        <div><a href="beneficios.html">Benef√≠cios</a></div>
        <div><a href="promocoes.html">Promo√ß√µes</a></div>
        <div><a href="duvidas.html">D√∫vidas</a></div>
        <div><a href="privacidade.html">Privacidade</a></div>
        <div><a href="termos.html">Termos</a></div>
        <div><a href="excluir.html">Excluir Dados</a></div>
      </div>
      <div>
        <div style="font-weight:900;margin-bottom:6px">Depoimentos</div>
        <div><a href="depoimentos.html">Ver depoimentos</a></div>
      </div>
    </div>
  </footer>

<script>
  // ‚úÖ SUA API (Apps Script)
  const API_URL = "https://script.google.com/macros/s/AKfycbzXZpsNWvfsfjoFRMhOn6SXnBEjnUcU-kcGPhGssr30Gl9TOyRUjQaz3GmVce7iGsBc/exec";

  const elLista = document.getElementById("listaParceiros");
  const elStatus = document.getElementById("status");

  const elBusca = document.getElementById("buscaNome");
  const elCidade = document.getElementById("filtroCidade");
  const elRamo = document.getElementById("filtroRamo");

  let parceiros = [];

  function normTxt(v){ return String(v ?? "").toLowerCase().trim(); }
  function isAtivo(v){
    const s = normTxt(v);
    return ["sim","true","1","ativo","yes"].includes(s);
  }
  function onlyDigits(v){ return String(v ?? "").replace(/\D/g,""); }
  function waLink(v){
    const d = onlyDigits(v);
    if(!d) return "";
    const br = d.startsWith("55") ? d : ("55" + d);
    return "https://wa.me/" + br;
  }

  function popularFiltros(lista){
    const cidades = [...new Set(lista.map(p => (p.cidade || p.Cidade || "")).filter(Boolean))].sort();
    const ramos   = [...new Set(lista.map(p => (p.ramo || p.Ramo || p.segmento || "")).filter(Boolean))].sort();

    elCidade.innerHTML = `<option value="">Todas as cidades</option>` + cidades.map(c => `<option>${c}</option>`).join("");
    elRamo.innerHTML   = `<option value="">Todos os ramos</option>` + ramos.map(r => `<option>${r}</option>`).join("");
  }

  function render(lista){
    if(!lista.length){
      elLista.innerHTML = "";
      elStatus.textContent = "Nenhum parceiro encontrado.";
      return;
    }
    elStatus.textContent = "";
    elLista.innerHTML = lista.map(p => {
      const nome = p.nomeFantasia || p.nome || p.razaoSocial || p.empresa || "Parceiro";
      const cidade = p.cidade || p.Cidade || "-";
      const ramo = p.ramo || p.Ramo || p.segmento || "-";
      const desc = p.desconto || p.beneficio || p.oferta || p.descricao || "";
      const logo = p.logoURL || p.logoUrl || p.logo || "logo-aproveitai.png";
      const w = waLink(p.whatsapp || p.celular || p.contato || "");
      const insta = p.instagram || "";

      return `
        <div class="card">
          <img class="logo" src="${logo}" onerror="this.src='logo-aproveitai.png'" alt="logo">
          <div>
            <p class="nome">${nome}</p>
            <div class="meta"><b>Cidade:</b> ${cidade}</div>
            <div class="meta"><b>Ramo:</b> ${ramo}</div>
            ${desc ? `<div class="meta"><b>Desconto:</b> ${desc}</div>` : ``}
            <div class="tag">
              ${w ? `<a href="${w}" target="_blank" rel="noreferrer" style="color:#0a4c1a;text-decoration:none">WhatsApp</a>` : `Contato`}
              ${insta ? ` ‚Ä¢ <a href="https://instagram.com/${insta.replace('@','')}" target="_blank" rel="noreferrer" style="color:#0a4c1a;text-decoration:none">${insta}</a>` : ``}
            </div>
          </div>
        </div>
      `;
    }).join("");
  }

  function aplicarFiltro(){
    const q = normTxt(elBusca.value);
    const c = normTxt(elCidade.value);
    const r = normTxt(elRamo.value);

    const filtrado = parceiros.filter(p => {
      const nome = normTxt(p.nomeFantasia || p.nome || p.razaoSocial || "");
      const cidade = normTxt(p.cidade || p.Cidade || "");
      const ramo = normTxt(p.ramo || p.Ramo || p.segmento || "");
      return (!q || nome.includes(q)) && (!c || cidade === c) && (!r || ramo === r);
    });

    render(filtrado);
  }

  async function carregarParceiros(){
    try{
      elStatus.textContent = "Carregando parceiros...";
      const res = await fetch(`${API_URL}?aba=parceiros`);
      const data = await res.json();

      // aceita array ou {data:[...]}
      const lista = Array.isArray(data) ? data : (data.data || []);
      parceiros = lista.filter(p => isAtivo(p.ativo ?? p.Ativo ?? p.status));

      popularFiltros(parceiros);
      render(parceiros);
    }catch(e){
      console.error(e);
      elStatus.textContent = "Erro ao carregar parceiros.";
      elLista.innerHTML = "";
    }
  }

  document.getElementById("btnFiltrar").addEventListener("click", aplicarFiltro);
  elBusca.addEventListener("input", aplicarFiltro);

  document.getElementById("btnQueroCliente").addEventListener("click", (e)=>{
    e.preventDefault();
    window.open("https://wa.me/5528999692303?text=" + encodeURIComponent("Ol√°! Quero ser cliente do Cart√£o AproveitAI."), "_blank");
  });
  document.getElementById("btnQueroParceiro").addEventListener("click", (e)=>{
    e.preventDefault();
    window.open("https://wa.me/5528999692303?text=" + encodeURIComponent("Ol√°! Quero ser parceiro do Cart√£o AproveitAI."), "_blank");
  });

  carregarParceiros();
</script>
</body>
</html>
